"use strict";$(function(){if(!getCookie("nickname"))return window.location.href="../html/login.html";var a=JSON.parse(window.localStorage.getItem("cart"))||[];function c(){var t=a.every(function(t){return"1"==t.is_select}),n=0;a.forEach(function(t){"1"===t.is_select&&(t.cart_number,n+=+t.price*t.cart_number)});var c='\n        <table class="haeder main">\n        <tr>\n            <td class="select">\n            <input type="checkbox" '.concat(t?"checked":"",'>全选\n            </td>\n            <td class="shop">\n                产品\n            </td>\n            <td class="num">\n                数量\n            </td>\n            <td class="price">\n                本店售价\n            </td>\n            <td class="subtotal">\n                小计\n            </td>\n            <td class="handle">\n                操作\n            </td>\n        </tr>\n    </table>\n        ');a.forEach(function(t){c+='\n        <table class="goods main">\n        <tr>\n            <td class="select" >\n                <input type="checkbox" data-id="'.concat(t.Id,'" ').concat("0"===t.is_select?"":"checked",'>\n            </td>\n            <td class="shop">\n                <img src="').concat(t.shop_img,'" alt="">\n                <p>').concat(t.title,'</p>\n            </td>\n            <td class="num">\n               <span class="subNum" data-id="').concat(t.Id,'">-</span>\n               <input type="text" value="').concat(t.cart_number,'" data-id="').concat(t.Id,'">\n               <span class="addNum" data-id="').concat(t.Id,'">+</span>\n            </td>\n            <td class="price">\n                <b>￥').concat(t.price,'</b>\n            </td>\n            <td class="subtotal">\n                <b>￥').concat((+t.price*t.cart_number).toFixed(2),'</b>\n                \n            </td>\n            <td class="handle">\n                <button data-id="').concat(t.Id,'">删除</button>\n            </td>\n        </tr>\n    </table>\n        ')}),c+='\n        <table class="foot">\n        <tr>\n            <td class="go">\n                <a href="../html/list.html">继续购物</a>\n            </td>\n            <td class="clearBox">\n                <button class="clear">\n                    清空购物车\n                </button>\n            </td>\n            <td class="totalBox">\n                应付总额：<span class = "total">￥'.concat(n.toFixed(2),'</span>\n            </td>\n            <td class="play">\n                <button>去结算</button>\n            </td>\n        </tr>\n    </table>\n        '),$(".shopList").html(c)}a.length?($(".empty").addClass("hide").siblings().removeClass("hide"),console.log(a),c(),$(".shopList").on("click",".goods .select>input",function(){var t=this.checked,n=$(this).data("id");a.filter(function(t){return t.Id==n})[0].is_select=t?"1":"0",c(),window.localStorage.setItem("cart",JSON.stringify(a))}),$(".shopList").on("click",".goods .num > .addNum",function(){var n=$(this).data("id"),t=a.filter(function(t){return t.Id==n})[0];t.cart_number=+t.cart_number+1,c(),window.localStorage.setItem("cart",JSON.stringify(a))}),$(".shopList").on("click",".goods .num > .subNum",function(){var n=$(this).data("id"),t=a.filter(function(t){return t.Id==n})[0];1!==t.cart_number&&(t.cart_number=+t.cart_number-1,c(),window.localStorage.setItem("cart",JSON.stringify(a)))}),$(".shopList").on("click",".goods .handle > button",function(){console.log(12);for(var t=$(this).data("id"),n=0;n<a.length;n++)if(a[n].Id==t){a.splice(n,1);break}if(c(),window.localStorage.setItem("cart",JSON.stringify(a)),!a.length)return window.location.reload()}),$(".shopList").on("click",".haeder .select",function(){$(".shopList .goods .select > input").prop("checked","checked"),$(".shopList goods .select>input").prop("checked","checked")}),$(".shopList").on("click",".foot .clear",function(){window.localStorage.removeItem("cart"),window.location.reload()})):$(".cartMain").addClass("hide").siblings().removeClass("hide")});