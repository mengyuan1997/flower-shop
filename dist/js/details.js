"use strict";function asyncGeneratorStep(t,e,s,n,i,a,o){try{var c=t[a](o),r=c.value}catch(t){return void s(t)}c.done?e(r):Promise.resolve(r).then(n,i)}function _asyncToGenerator(c){return function(){var t=this,o=arguments;return new Promise(function(e,s){var n=c.apply(t,o);function i(t){asyncGeneratorStep(n,e,s,i,a,"next",t)}function a(t){asyncGeneratorStep(n,e,s,i,a,"throw",t)}i(void 0)})}}function fdj(){function t(t){this.ele=document.querySelector(t),this.show=this.ele.querySelector(".show"),this.enlarge=this.ele.querySelector(".enlarge"),this.mask=this.ele.querySelector(".mask"),this.cut=this.ele.querySelector(".cut"),this.showWidth=this.show.clientWidth,this.showHeight=this.show.clientHeight,this.enlargeWidth=parseInt(window.getComputedStyle(this.enlarge).width),this.enlargeHeight=parseInt(window.getComputedStyle(this.enlarge).height),this.bgWidth=parseInt(window.getComputedStyle(this.enlarge).backgroundSize.split(" ")[0]),this.bgHeight=parseInt(window.getComputedStyle(this.enlarge).backgroundSize.split(" ")[1]),this.come()}t.prototype.come=function(){this.ratio(),this.overOut(),this.move(),this.choose()},t.prototype.ratio=function(){this.maskWidth=this.showWidth*this.enlargeWidth/this.bgWidth,this.maskHeight=this.showHeight*this.enlargeHeight/this.bgHeight,this.mask.style.width=this.maskWidth+"px",this.mask.style.height=this.maskHeight+"px"},t.prototype.overOut=function(){var t=this;this.show.addEventListener("mouseover",function(){t.mask.style.display="block",t.enlarge.style.display="block"}),this.show.addEventListener("mouseout",function(){t.mask.style.display="none",t.enlarge.style.display="none"})},t.prototype.move=function(){var s=this;this.show.addEventListener("mousemove",function(t){var e=(t=t||window.event).offsetX-s.maskWidth/2,t=t.offsetY-s.maskHeight/2;e<=0&&(e=0),t<=0&&(t=0),e>=s.showWidth-s.maskWidth&&(e=s.showWidth-s.maskWidth),t>=s.showHeight-s.maskHeight&&(t=s.showHeight-s.maskHeight),s.mask.style.left=e+"px",s.mask.style.top=t+"px";e=s.enlargeWidth*e/s.maskWidth,t=s.enlargeHeight*t/s.maskHeight;s.enlarge.style.backgroundPosition="-".concat(e,"px -").concat(t,"px")})},t.prototype.choose=function(){var i=this;this.cut.addEventListener("click",function(t){var e=(t=t||window.event).target||t.srcElement;if("IMG"===e.nodeName){var s=e.getAttribute("show"),t=e.getAttribute("bg");i.show.firstElementChild.src=s,i.enlarge.style.backgroundImage="url(".concat(t,")");for(var n=0;n<i.cut.children.length;n++)i.cut.children[n].classList.remove("pintch");e.parentElement.classList.add("pintch")}})};new t("#glassBox")}$(function(){var n=null,i=getCookie("shop_id");function t(){return(t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$.get("/dl/getGood.php",{shop_id:i},null,"json");case 2:s=t.sent,console.log(s.shop),e=s.shop,$("#glassBox").html('\n        <div class="show">\n                <img src="'.concat(e.img1,'" alt="">\n                <div class="mask">&nbsp;</div>\n            </div>\n           \n            <div class="cut">\n                <li class ="pintch"><img src="').concat(e.img1,'" show = "').concat(e.img1,'" bg ="').concat(e.img1,'" alt=""></li>\n                <li ><img src="').concat(e.img2,'" show = "').concat(e.img2,'" bg ="').concat(e.img2,'" alt=""></li>\n            </div>\n           \n            <div class="enlarge" style>&nbsp;</div>\n        ')),fdj(),$(".message").html('\n        <h5 class="title">'.concat(e.title,'</h5>\n           <p class="descirbe">').concat(e.describe,'</p>\n           <div class="pricebox">\n               <p>销售价:</p>\n               <h4 class="price">￥').concat(e.price,'</h4>\n           </div>\n           <div class="saEv">\n               <p>累计评价<span class="sale">').concat(e.evaluate,'</span> </p>|\n               <p>累计销量<span class="evaluate">').concat(e.sale,'</span> </p>\n           </div>\n           <div class="num">\n               <span>数量</span>\n               <b class="addNum">+</b>\n               <input type="text" value="1" class="cartNum">\n               <b class="subNum">-</b>\n               <p>件&nbsp;&nbsp;库存 <span class="inven">1308</span>件 </p>\n           </div>\n           <div class="cartBox">\n            <a href="#" class="btn btn-default" role="button">  收藏</a>\n            <a  class="btn btn-primary addCart" role="button" data-shop_id=').concat(e.Id,'> <img src="../images/icon_cart.png" alt=""> 加入购车</a>\n            <a >&nbsp;</a>\n            <a >&nbsp;</a>\n       </div>\n        ')),$("#dateils").html("".concat(e.details)),n=s.shop;case 6:case"end":return t.stop()}var e},t)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}(),$(".message").on("click",".addCart",function(){var t=JSON.parse(window.localStorage.getItem("cart"))||[];console.log(t,"加入购物车，70");var e=t.some(function(t){return t.Id==n.Id});console.log(e,"商品是否存在，72"),e?(e=t.filter(function(t){return t.Id==n.Id})[0],console.log(e,"75"),e.cart_number=+e.cart_number+ +$(".cartNum").val()):(n.cart_number=1,t.push(n)),window.localStorage.setItem("cart",JSON.stringify(t))}),$(".message").on("click",".subNum",function(){var t=+$(".cartNum").val();1!=t&&$(".cartNum").val(t-1)}).on("click",".addNum",function(){var t=+$(".cartNum").val();$(".cartNum").val(1+t)})});